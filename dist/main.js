class ya{state;listeners=new Set;constructor(a){this.state=a}getState(){return this.state}setState(a){this.state={...this.state,...a},this.listeners.forEach((e)=>e(this.state))}subscribe(a){return this.listeners.add(a),()=>this.listeners.delete(a)}}var u;function ba(a){return u=new ya(a),u}var he={"":"today",today:"today",calendar:"calendar",duas:"duas",quran:"quran",settings:"settings"};class Sa{listeners=new Set;current="today";init(){window.addEventListener("hashchange",()=>this.handleHash()),this.handleHash()}handleHash(){let a=window.location.hash.replace("#/","").replace("#",""),e=he[a]||"today";if(e!==this.current)this.current=e,this.listeners.forEach((t)=>t(e))}navigate(a){window.location.hash=`#/${a==="today"?"":a}`}getCurrentRoute(){return this.current}onRouteChange(a){return this.listeners.add(a),()=>this.listeners.delete(a)}}var y=new Sa;var P={city:"dhaka",cityDisplay:"Dhaka",methodId:1,methodName:"University of Islamic Sciences, Karachi",school:1,theme:"dark",lastSaved:""};var va="Ramadan Bangladesh",ia="https://api.aladhan.com/v1",Na="Bangladesh",Ea=86400000,Aa=1e4,j="ramadan-bd",w=1,oa="ramadan-bd-settings";function Ca(){try{let a=localStorage.getItem(oa);if(!a)return{...P};let e=JSON.parse(a);return{...P,...e}}catch{return{...P}}}function za(a){a.lastSaved=new Date().toISOString(),localStorage.setItem(oa,JSON.stringify(a))}function E(a,e,t,n,s){return`aladhan:${a}:${e}:${t}:${n}:${s}`}var F=null;function la(){if(F)return Promise.resolve(F);return new Promise((a,e)=>{let t=indexedDB.open(j,w);t.onupgradeneeded=()=>{let n=t.result;if(!n.objectStoreNames.contains("monthTimings"))n.createObjectStore("monthTimings",{keyPath:"cacheKey"});if(!n.objectStoreNames.contains("duaFavorites"))n.createObjectStore("duaFavorites",{keyPath:"duaId"});if(!n.objectStoreNames.contains("quranProgress"))n.createObjectStore("quranProgress",{keyPath:"id"})},t.onsuccess=()=>{F=t.result,a(F)},t.onerror=()=>e(t.error)})}async function Da(a){try{let e=await la();return new Promise((t,n)=>{let i=e.transaction("monthTimings","readonly").objectStore("monthTimings").get(a);i.onsuccess=()=>t(i.result||null),i.onerror=()=>n(i.error)})}catch{return null}}async function ka(a){try{let e=await la();return new Promise((t,n)=>{let s=e.transaction("monthTimings","readwrite");s.objectStore("monthTimings").put(a),s.oncomplete=()=>t(),s.onerror=()=>n(s.error)})}catch{}}function ja(a){let e=new Date(a.fetchedAt).getTime();return Date.now()-e<Ea}async function wa(){try{await la()}catch{console.warn("IndexedDB unavailable — using in-memory only")}}async function da(a){let e=null;for(let t=0;t<2;t++)try{let n=new AbortController,s=setTimeout(()=>n.abort(),Aa),o=await fetch(a,{signal:n.signal});if(clearTimeout(s),!o.ok)throw Error(`HTTP ${o.status}: ${o.statusText}`);return await o.json()}catch(n){if(e=n,n.name!=="AbortError"&&!n.message?.includes("fetch"))throw n;if(t===0)await new Promise((s)=>setTimeout(s,1000))}throw e||Error("Fetch failed")}function S(a){return a.replace(/\s*\(.*\)$/,"").trim()}function ue(a){let e=a.timings,t=a.date.hijri,n=a.date.gregorian,s=S(e.Imsak||""),o=S(e.Fajr||""),i=s&&s!=="00:00"&&s!=="Invalid date",l=[...t.holidays||[],...t.adjustedHolidays||[]],d={Imsak:s,Fajr:o,Sunrise:S(e.Sunrise||""),Dhuhr:S(e.Dhuhr||""),Asr:S(e.Asr||""),Maghrib:S(e.Maghrib||""),Isha:S(e.Isha||""),SehriEnds:i?s:o,SehriEndsLabel:i?"Imsak":"Fajr (est.)",Iftar:S(e.Maghrib||"")};return{dateGregorian:n.date,dateReadable:a.date.readable,timestamp:parseInt(a.date.timestamp,10),weekday:n.weekday.en,hijriDisplay:`${t.day} ${t.month.en} ${t.year}`,hijriMonth:t.month.number,hijriDay:parseInt(t.day,10),hijriYear:parseInt(t.year,10),isRamadan:t.month.number===9,holidays:l,prayers:d}}function Ta(a,e){return{cacheKey:e,fetchedAt:new Date().toISOString(),days:a.map(ue)}}var R=null;async function O(){if(R)return R;let a=await da(`${ia}/methods`);return R=Object.values(a.data).filter((e)=>e.id!==99).map((e)=>({id:e.id,name:e.name})).sort((e,t)=>e.id-t.id),R}async function La(a){let{city:e,year:t,month:n,methodId:s,school:o}=a,i=new URL(`${ia}/calendarByCity/${t}/${n}`);i.searchParams.set("city",e),i.searchParams.set("country",Na),i.searchParams.set("method",String(s)),i.searchParams.set("school",String(o));let l=await da(i.toString()),d=E(e.toLowerCase(),s,o,t,n);return Ta(l.data,d)}function B(){let a=new Date,e=String(a.getDate()).padStart(2,"0"),t=String(a.getMonth()+1).padStart(2,"0"),n=a.getFullYear();return`${e}-${t}-${n}`}function A(){return new Date().getFullYear()}function C(){return new Date().getMonth()+1}function xa(a){return["","January","February","March","April","May","June","July","August","September","October","November","December"][a]||""}function Ia(){return new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}async function H(a,e,t){let n=e??A(),s=t??C(),o=E(a.city,a.methodId,a.school,n,s),i=await Da(o);if(i){if(ja(i))return{data:i,source:"fresh-cache"};return me(a,n,s),{data:i,source:"stale-cache"}}return M(a,n,s)}async function M(a,e,t){try{let n=await La({city:a.cityDisplay,year:e,month:t,methodId:a.methodId,school:a.school});return await ka(n),{data:n,source:"network"}}catch(n){return{data:null,source:"error",error:n.message}}}function me(a,e,t){M(a,e,t).catch(()=>{})}async function Ha(a){let e=A(),t=C(),n=await H(a,e,t),s=null;if(t===2)s=await H(a,e,3);else if(t===3)s=await H(a,e,2);return{current:n,other:s}}class qa{online=navigator.onLine;listeners=new Set;init(){window.addEventListener("online",()=>this.update(!0)),window.addEventListener("offline",()=>this.update(!1))}update(a){this.online=a,this.listeners.forEach((e)=>e(a))}isOnline(){return this.online}onChange(a){return this.listeners.add(a),()=>this.listeners.delete(a)}}var v=new qa;function r(a,e,...t){let n=document.createElement(a);if(e)for(let[s,o]of Object.entries(e))if(s==="className")n.className=o;else if(s==="textContent")n.textContent=o;else if(s==="innerHTML")n.innerHTML=o;else n.setAttribute(s,o);for(let s of t)if(typeof s==="string")n.appendChild(document.createTextNode(s));else n.appendChild(s);return n}function c(a,...e){a.innerHTML="";for(let t of e)a.appendChild(t)}var ce=[{route:"today",icon:"☪",label:"Today"},{route:"calendar",icon:"\uD83D\uDCC5",label:"Calendar"},{route:"duas",icon:"\uD83E\uDD32",label:"Duas"},{route:"quran",icon:"\uD83D\uDCD6",label:"Quran"},{route:"settings",icon:"⚙",label:"Settings"}];function $a(){let a=r("nav",{className:"nav-bar",role:"navigation","aria-label":"Main navigation"});function e(){a.innerHTML="";let t=y.getCurrentRoute();for(let n of ce){let s=r("button",{className:`nav-tab${n.route===t?" active":""}`,"aria-label":n.label,"aria-current":n.route===t?"page":""}),o=r("span",{className:"nav-icon","aria-hidden":"true"},n.icon),i=r("span",null,n.label);s.appendChild(o),s.appendChild(i),s.addEventListener("click",()=>y.navigate(n.route)),a.appendChild(s)}}return e(),y.onRouteChange(()=>e()),a}function Pa(){let a=r("div",{className:"offline-banner",role:"alert"},"You are offline — showing cached data");function e(t){a.classList.toggle("show",!t)}return e(v.isOnline()),v.onChange(e),a}var T=["Fajr","Sunrise","Dhuhr","Asr","Maghrib","Isha"];function G(a){let[e,t]=a.split(":").map(Number);return e*60+t}function Fa(a){if(a<=0)return"0m 0s";let e=Math.floor(a/1000),t=Math.floor(e/3600),n=Math.floor(e%3600/60),s=e%60;if(t>0)return`${t}h ${n}m ${s}s`;if(n>0)return`${n}m ${s}s`;return`${s}s`}function pa(a){let e=new Date,t=e.getHours()*60+e.getMinutes(),n=e.getHours()*3600000+e.getMinutes()*60000+e.getSeconds()*1000;for(let s of T){let o=a.prayers[s],i=G(o);if(i>t){let d=i*60000-n,h=T.indexOf(s)-1,g=h>=0?G(a.prayers[T[h]]):0,f=i-g,x=t-g,I=f>0?Math.min(1,Math.max(0,x/f)):0;return{name:s,time:o,remainingMs:d,remainingDisplay:Fa(d),progress:I}}}return null}function Ra(a){let e=new Date,t=e.getHours()*60+e.getMinutes();return G(a)<=t}function Oa(a,e){return e?.name===a}function Ba(a){let e=r("div",{className:"hero-container"}),t=r("div",{className:"hero-card"});t.appendChild(r("div",{className:"hero-label"},"Sehri Ends")),t.appendChild(r("div",{className:"hero-time"},a.SehriEnds)),t.appendChild(r("div",{className:"hero-sublabel"},`(${a.SehriEndsLabel})`));let n=r("div",{className:"hero-card"});return n.appendChild(r("div",{className:"hero-label"},"Iftar")),n.appendChild(r("div",{className:"hero-time"},a.Iftar)),n.appendChild(r("div",{className:"hero-sublabel"},"(Maghrib)")),e.appendChild(t),e.appendChild(n),e}function Ma(a){let e=r("section",{className:"countdown-section","aria-live":"polite"});if(!a)return e.appendChild(r("div",{className:"countdown-label"},"All prayers completed for today")),e;let t=r("div",{className:"countdown-label"});t.innerHTML=`NEXT: <span class="countdown-next-name">${a.name}</span>`;let n=r("div",{className:"countdown-bar"}),s=r("div",{className:"countdown-bar-fill"});s.style.width=`${Math.round(a.progress*100)}%`,n.appendChild(s);let o=r("div",{className:"countdown-remaining"},a.remainingDisplay);return e.appendChild(t),e.appendChild(n),e.appendChild(o),e}function Ga(a,e){if(!e){a.innerHTML='<div class="countdown-label">All prayers completed for today</div>';return}let t=a.querySelector(".countdown-next-name");if(t)t.textContent=e.name;let n=a.querySelector(".countdown-bar-fill");if(n)n.style.width=`${Math.round(e.progress*100)}%`;let s=a.querySelector(".countdown-remaining");if(s)s.textContent=e.remainingDisplay}function ha(a,e){let t=r("div",{className:"prayer-list"});for(let n of T){let s=a.prayers[n],o=Ra(s),i=Oa(n,e),l=r("div",{className:`prayer-card${o?" past":""}${i?" next":""}`}),d=r("span",{className:"prayer-name"},n),h=r("span",null),g=r("span",{className:"prayer-time"},s);if(h.appendChild(g),o&&!i){let f=r("span",{className:"prayer-indicator","aria-label":"Passed"}," ✓");h.appendChild(f)}else if(i){let f=r("span",{className:"prayer-indicator","aria-label":"Next prayer"}," ←");h.appendChild(f)}l.appendChild(d),l.appendChild(h),t.appendChild(l)}return t}function Qa(a){let e=a.school===1?"Hanafi":"Shafi",t=`${a.cityDisplay} · ${a.methodName.split(",")[0]} · ${e}`;return r("div",{className:"transparency-footer"},t)}function q(){let a=r("div",null);a.appendChild(r("div",{className:"skeleton skeleton-line short",style:"height: 24px;"})),a.appendChild(r("div",{className:"skeleton skeleton-line",style:"height: 16px; width: 50%; margin-top: 8px;"}));let e=r("div",{className:"skeleton-hero"});e.appendChild(r("div",{className:"skeleton"})),e.appendChild(r("div",{className:"skeleton"})),a.appendChild(e),a.appendChild(r("div",{className:"skeleton skeleton-card",style:"height: 80px; margin-bottom: 16px;"}));for(let t=0;t<6;t++)a.appendChild(r("div",{className:"skeleton skeleton-card"}));return a}var z=null;function _a(a){let e=u.getState();if(z)clearInterval(z),z=null;if(e.isLoading&&!e.todayData){c(a,q());return}if(e.error&&!e.todayData){let d=r("div",{className:"error-state"});d.appendChild(r("div",{className:"error-icon"},"⚠")),d.appendChild(r("div",{className:"error-message"},e.error));let h=r("button",{className:"btn-retry"},"Try Again");h.addEventListener("click",()=>{window.location.reload()}),d.appendChild(h),c(a,d);return}let t=e.todayData;if(!t){c(a,q());return}let n=e.settings,s=document.createDocumentFragment(),o=r("header",{className:"page-header"});o.appendChild(r("div",{className:"app-name"},`☪ ${va}`)),o.appendChild(r("div",{className:"hijri-date"},t.hijriDisplay)),o.appendChild(r("div",{className:"greg-date"},Ia())),s.appendChild(o),s.appendChild(Ba(t.prayers));let i=pa(t),l=Ma(i);if(s.appendChild(l),s.appendChild(ha(t,i)),t.isRamadan){let d=r("div",{className:"ramadan-counter"});d.innerHTML=`Day <strong>${t.hijriDay}</strong> of Ramaḍān`,s.appendChild(d)}s.appendChild(Qa(n)),c(a,s),z=window.setInterval(()=>{let d=pa(t);if(Ga(l,d),d?.name!==i?.name){let h=a.querySelector(".prayer-list");if(h){let g=ha(t,d);h.replaceWith(g)}}},1000)}function Ja(){if(z)clearInterval(z),z=null}function Ya(){let a=u.getState(),e=B();if(a.currentMonthData){let t=a.currentMonthData.days.find((n)=>n.dateGregorian===e);if(t)return t}if(a.otherMonthData){let t=a.otherMonthData.days.find((n)=>n.dateGregorian===e);if(t)return t}return null}function Ka(a){let e=a.dateGregorian===B(),t=a.isRamadan,n=a.holidays.some((h)=>h.toLowerCase().includes("lailat")),s=a.holidays.some((h)=>h.toLowerCase().includes("eid")),o="day-row";if(e)o+=" today";if(!t)o+=" non-ramadan";let i=r("div",{className:o}),l=r("div",{className:"day-row-header"});l.appendChild(r("span",{className:"day-row-date"},`${a.dateReadable} · ${a.weekday}`)),l.appendChild(r("span",{className:"day-row-hijri"},a.hijriDisplay)),i.appendChild(l);let d=r("div",{className:"day-row-times"});if(d.innerHTML=`
    <span>Sehri: <strong>${a.prayers.SehriEnds}</strong></span>
    <span>Iftar: <strong>${a.prayers.Iftar}</strong></span>
    <span>Fajr: <strong>${a.prayers.Fajr}</strong></span>
  `,i.appendChild(d),e)i.appendChild(r("span",{className:"day-badge today-badge"},"TODAY"));if(n)i.appendChild(r("span",{className:"day-badge holiday-badge"},"⭐ Lailat-ul-Qadr"));if(s)i.appendChild(r("span",{className:"day-badge eid-badge"},"\uD83C\uDF89 Eid ul-Fitr"));return i}var L=A(),b=C();function Q(a){let e=u.getState(),t=document.createDocumentFragment();t.appendChild(r("h1",{className:"page-title"},"Calendar"));let n=r("div",{className:"month-nav"}),s=r("button",{className:"month-nav-btn","aria-label":"Previous month"},"◀");s.addEventListener("click",()=>Ua(-1,a));let o=r("span",{className:"month-nav-title"},`${xa(b)} ${L}`),i=r("button",{className:"month-nav-btn","aria-label":"Next month"},"▶");i.addEventListener("click",()=>Ua(1,a)),n.appendChild(s),n.appendChild(o),n.appendChild(i),t.appendChild(n);let l=ge();if(!l){if(e.isLoading)t.appendChild(q());else{let d=r("div",{className:"error-state"});d.appendChild(r("div",{className:"error-message"},"Loading calendar data...")),t.appendChild(d),fe(a)}c(a,t);return}for(let d of l.days)t.appendChild(Ka(d));c(a,t)}function ge(){let a=u.getState();if(a.currentMonthData){let e=a.currentMonthData.days[0];if(e){let[,t,n]=e.dateGregorian.split("-").map(Number);if(t===b&&n===L)return a.currentMonthData}}if(a.otherMonthData){let e=a.otherMonthData.days[0];if(e){let[,t,n]=e.dateGregorian.split("-").map(Number);if(t===b&&n===L)return a.otherMonthData}}return null}async function fe(a){let e=u.getState().settings;u.setState({isLoading:!0});let t=await H(e,L,b);if(t.data)u.setState({otherMonthData:t.data,isLoading:!1});else u.setState({isLoading:!1,error:t.error||"Failed to load calendar"});Q(a)}function Ua(a,e){if(b+=a,b>12)b=1,L++;if(b<1)b=12,L--;Q(e)}var ua=[{name:"Dhaka",normalized:"dhaka"},{name:"Chittagong",normalized:"chittagong"},{name:"Khulna",normalized:"khulna"},{name:"Rajshahi",normalized:"rajshahi"},{name:"Sylhet",normalized:"sylhet"},{name:"Rangpur",normalized:"rangpur"},{name:"Barisal",normalized:"barisal"},{name:"Mymensingh",normalized:"mymensingh"},{name:"Comilla",normalized:"comilla"},{name:"Gazipur",normalized:"gazipur"},{name:"Narayanganj",normalized:"narayanganj"},{name:"Cox's Bazar",normalized:"coxs bazar"},{name:"Jessore",normalized:"jessore"},{name:"Bogra",normalized:"bogra"},{name:"Dinajpur",normalized:"dinajpur"},{name:"Tangail",normalized:"tangail"},{name:"Noakhali",normalized:"noakhali"},{name:"Brahmanbaria",normalized:"brahmanbaria"},{name:"Narsingdi",normalized:"narsingdi"},{name:"Faridpur",normalized:"faridpur"},{name:"Pabna",normalized:"pabna"},{name:"Jamalpur",normalized:"jamalpur"},{name:"Kushtia",normalized:"kushtia"},{name:"Habiganj",normalized:"habiganj"},{name:"Moulvibazar",normalized:"moulvibazar"},{name:"Sunamganj",normalized:"sunamganj"},{name:"Netrokona",normalized:"netrokona"},{name:"Sherpur",normalized:"sherpur"},{name:"Kishoreganj",normalized:"kishoreganj"},{name:"Manikganj",normalized:"manikganj"},{name:"Munshiganj",normalized:"munshiganj"},{name:"Madaripur",normalized:"madaripur"},{name:"Gopalganj",normalized:"gopalganj"},{name:"Shariatpur",normalized:"shariatpur"},{name:"Rajbari",normalized:"rajbari"},{name:"Satkhira",normalized:"satkhira"},{name:"Bagerhat",normalized:"bagerhat"},{name:"Narail",normalized:"narail"},{name:"Magura",normalized:"magura"},{name:"Jhenaidah",normalized:"jhenaidah"},{name:"Meherpur",normalized:"meherpur"},{name:"Chuadanga",normalized:"chuadanga"},{name:"Kurigram",normalized:"kurigram"},{name:"Lalmonirhat",normalized:"lalmonirhat"},{name:"Nilphamari",normalized:"nilphamari"},{name:"Gaibandha",normalized:"gaibandha"},{name:"Thakurgaon",normalized:"thakurgaon"},{name:"Panchagarh",normalized:"panchagarh"},{name:"Joypurhat",normalized:"joypurhat"},{name:"Naogaon",normalized:"naogaon"},{name:"Natore",normalized:"natore"},{name:"Nawabganj",normalized:"nawabganj"},{name:"Sirajganj",normalized:"sirajganj"},{name:"Pirojpur",normalized:"pirojpur"},{name:"Jhalokati",normalized:"jhalokati"},{name:"Barguna",normalized:"barguna"},{name:"Patuakhali",normalized:"patuakhali"},{name:"Bhola",normalized:"bhola"},{name:"Feni",normalized:"feni"},{name:"Lakshmipur",normalized:"lakshmipur"},{name:"Chandpur",normalized:"chandpur"},{name:"Bandarban",normalized:"bandarban"},{name:"Rangamati",normalized:"rangamati"},{name:"Khagrachari",normalized:"khagrachari"}];var Va=[1,3,5,2];async function Za(a){let e=u.getState(),t={...e.settings},n=e.methods;if(!n)try{n=await O(),u.setState({methods:n})}catch{n=[{id:1,name:"University of Islamic Sciences, Karachi"},{id:3,name:"Muslim World League"},{id:5,name:"Egyptian General Authority of Survey"},{id:2,name:"Islamic Society of North America (ISNA)"}]}let s=document.createDocumentFragment();s.appendChild(r("h1",{className:"page-title"},"Settings"));let o=r("div",{className:"settings-form"}),i=r("div",{className:"form-group"});i.appendChild(r("label",{className:"form-label"},"City"));let l=r("select",{className:"form-select","aria-label":"Select city"});for(let p of ua){let m=r("option",{value:p.name});if(m.textContent=p.name,p.normalized===t.city)m.selected=!0;l.appendChild(m)}l.addEventListener("change",()=>{let p=ua.find((m)=>m.name===l.value);if(p)t.city=p.normalized,t.cityDisplay=p.name}),i.appendChild(l),o.appendChild(i);let d=r("div",{className:"form-group"});d.appendChild(r("label",{className:"form-label"},"Calculation Method"));let h=r("select",{className:"form-select","aria-label":"Select calculation method"}),g=n.filter((p)=>Va.includes(p.id)),f=n.filter((p)=>!Va.includes(p.id));for(let p of g){let m=r("option",{value:String(p.id)});if(m.textContent=p.id===1?`★ ${p.name} (Recommended)`:p.name,p.id===t.methodId)m.selected=!0;h.appendChild(m)}if(f.length>0){let p=r("optgroup",{label:"Other methods"});for(let m of f){let N=r("option",{value:String(m.id)});if(N.textContent=m.name,m.id===t.methodId)N.selected=!0;p.appendChild(N)}h.appendChild(p)}h.addEventListener("change",()=>{let p=parseInt(h.value),m=n.find((N)=>N.id===p);if(m)t.methodId=p,t.methodName=m.name}),d.appendChild(h),d.appendChild(r("div",{className:"form-hint"},"★ Recommended for Bangladesh")),o.appendChild(d);let x=r("div",{className:"form-group"});x.appendChild(r("label",{className:"form-label"},"Asr Calculation"));let I=r("div",{className:"radio-group"}),U=r("label",{className:"radio-option"}),V=r("input",{type:"radio",name:"school",value:"1"});if(t.school===1)V.checked=!0;V.addEventListener("change",()=>{t.school=1}),U.appendChild(V),U.appendChild(document.createTextNode(" Hanafi (recommended)")),I.appendChild(U);let Z=r("label",{className:"radio-option"}),W=r("input",{type:"radio",name:"school",value:"0"});if(t.school===0)W.checked=!0;W.addEventListener("change",()=>{t.school=0}),Z.appendChild(W),Z.appendChild(document.createTextNode(" Shafi")),I.appendChild(Z),x.appendChild(I),o.appendChild(x);let X=r("div",{className:"form-group"});X.appendChild(r("label",{className:"form-label"},"Theme"));let aa=r("div",{className:"radio-group"}),ea=r("label",{className:"radio-option"}),ta=r("input",{type:"radio",name:"theme",value:"dark"});if(t.theme==="dark")ta.checked=!0;ta.addEventListener("change",()=>{t.theme="dark"}),ea.appendChild(ta),ea.appendChild(document.createTextNode(" Dark")),aa.appendChild(ea);let na=r("label",{className:"radio-option"}),ra=r("input",{type:"radio",name:"theme",value:"light"});if(t.theme==="light")ra.checked=!0;ra.addEventListener("change",()=>{t.theme="light"}),na.appendChild(ra),na.appendChild(document.createTextNode(" Light")),aa.appendChild(na),X.appendChild(aa),o.appendChild(X);let k=r("button",{className:"btn-save"},"\uD83D\uDCBE Save Settings");if(!v.isOnline())k.disabled=!0,k.title="Connect to update";k.addEventListener("click",async()=>{k.disabled=!0,k.textContent="Saving...",za(t),document.documentElement.setAttribute("data-theme",t.theme);let p=A(),m=C(),N=E(e.settings.city,e.settings.methodId,e.settings.school,p,m),oe=E(t.city,t.methodId,t.school,p,m);if(N!==oe){let $=await M(t,p,m);if($.data)u.setState({settings:t,currentMonthData:$.data,todayData:$.data.days.find((le)=>{let sa=new Date,de=String(sa.getDate()).padStart(2,"0"),pe=String(sa.getMonth()+1).padStart(2,"0");return le.dateGregorian===`${de}-${pe}-${sa.getFullYear()}`})||null});else u.setState({settings:t,error:$.error||null})}else u.setState({settings:t});be("Settings saved"),y.navigate("today")}),o.appendChild(k),s.appendChild(o);let fa=r("div",{className:"settings-footer"});fa.innerHTML=`
    App version 1.0.0<br>
    Data from <a href="https://aladhan.com" target="_blank" rel="noopener">AlAdhan.com</a>
  `,s.appendChild(fa),c(a,s)}function be(a){let e=document.querySelector(".toast");if(!e)e=r("div",{className:"toast"}),document.body.appendChild(e);e.textContent=a,e.classList.add("show"),setTimeout(()=>e.classList.remove("show"),2000)}var _=null;function Wa(){if(_)return Promise.resolve(_);return new Promise((a,e)=>{let t=indexedDB.open(j,w);t.onsuccess=()=>{_=t.result,a(_)},t.onerror=()=>e(t.error)})}async function ma(){try{let a=await Wa();return new Promise((e,t)=>{let o=a.transaction("duaFavorites","readonly").objectStore("duaFavorites").getAll();o.onsuccess=()=>{let i=(o.result||[]).map((l)=>l.duaId);e(new Set(i))},o.onerror=()=>t(o.error)})}catch{return new Set}}async function Xa(a){try{let e=await Wa(),n=(await ma()).has(a);return new Promise((s,o)=>{let i=e.transaction("duaFavorites","readwrite"),l=i.objectStore("duaFavorites");if(n)l.delete(a);else l.put({duaId:a});i.oncomplete=()=>s(!n),i.onerror=()=>o(i.error)})}catch{return!1}}function ae(a,e,t){let n=r("div",{className:"dua-card"}),s=r("div",{className:"dua-card-header"});s.appendChild(r("span",{className:"dua-card-title"},a.titleEn));let o=r("button",{className:"dua-fav-btn","aria-label":e?"Remove from favorites":"Add to favorites"},e?"♥":"♡");return o.addEventListener("click",()=>{t(a.id)}),s.appendChild(o),n.appendChild(s),n.appendChild(r("div",{className:"dua-arabic",lang:"ar",dir:"rtl"},a.arabicText)),n.appendChild(r("div",{className:"dua-transliteration"},a.transliteration)),n.appendChild(r("div",{className:"dua-translation"},a.translationEn)),n.appendChild(r("div",{className:"dua-source"},`\uD83D\uDCD6 ${a.source}`)),n}var ee=[{id:"iftar-1",titleEn:"Dua for Breaking Fast",arabicText:"اللَّهُمَّ إِنِّي لَكَ صُمْتُ وَبِكَ آمَنْتُ وَعَلَى رِزْقِكَ أَفْطَرْتُ",transliteration:"Allahumma inni laka sumtu wa bika aamantu wa 'ala rizqika aftartu",translationEn:"O Allah! I fasted for You and I believe in You and I break my fast with Your sustenance.",category:"iftar",source:"Abu Dawud 2358"},{id:"iftar-2",titleEn:"Dua When Breaking Fast",arabicText:"ذَهَبَ الظَّمَأُ وَابْتَلَّتِ الْعُرُوقُ وَثَبَتَ الْأَجْرُ إِنْ شَاءَ اللَّهُ",transliteration:"Dhahaba al-zama'u wabtallatil-'urooqu wa thabatal-ajru inshaa'Allah",translationEn:"The thirst has gone, the veins are moistened, and the reward is confirmed, if Allah wills.",category:"iftar",source:"Abu Dawud 2357"},{id:"sehri-1",titleEn:"Intention for Fasting (Niyyah)",arabicText:"وَبِصَوْمِ غَدٍ نَوَيْتُ مِنْ شَهْرِ رَمَضَانَ",transliteration:"Wa bisawmi ghadin nawaytu min shahri ramadan",translationEn:"I intend to keep the fast for tomorrow in the month of Ramadan.",category:"sehri",source:"Abu Dawud 2454"},{id:"sehri-2",titleEn:"Dua Before Eating Sehri",arabicText:"بِسْمِ اللَّهِ وَعَلَى بَرَكَةِ اللَّهِ",transliteration:"Bismillahi wa 'ala barakatillah",translationEn:"In the name of Allah and with the blessings of Allah.",category:"sehri",source:"General practice"},{id:"general-1",titleEn:"Dua for Forgiveness",arabicText:"رَبَّنَا اغْفِرْ لِي وَلِوَالِدَيَّ وَلِلْمُؤْمِنِينَ يَوْمَ يَقُومُ الْحِسَابُ",transliteration:"Rabbana-ghfir li wa li-walidayya wa lil-mu'mineena yawma yaqoomul-hisaab",translationEn:"Our Lord, forgive me and my parents and the believers the Day the account is established.",category:"general",source:"Quran 14:41"},{id:"general-2",titleEn:"Dua for Mercy",arabicText:"رَبِّ اغْفِرْ وَارْحَمْ وَأَنْتَ خَيْرُ الرَّاحِمِينَ",transliteration:"Rabbighfir warham wa anta khairur-raahimeen",translationEn:"My Lord, forgive and have mercy, and You are the best of the merciful.",category:"general",source:"Quran 23:118"},{id:"general-3",titleEn:"Dua of the Fasting Person",arabicText:"إِنَّ لِلصَّائِمِ عِنْدَ فِطْرِهِ لَدَعْوَةً مَا تُرَدُّ",transliteration:"Inna lis-saa'imi 'inda futrihi lada'watan maa turaddu",translationEn:"The fasting person has a supplication at the time of breaking fast that is not rejected.",category:"general",source:"Ibn Majah 1753"},{id:"general-4",titleEn:"Dua for Guidance",arabicText:"اللَّهُمَّ إِنِّي أَسْأَلُكَ الْهُدَى وَالتُّقَى وَالْعَفَافَ وَالْغِنَى",transliteration:"Allahumma inni as'alukal-huda wat-tuqa wal-'afaafa wal-ghina",translationEn:"O Allah, I ask You for guidance, piety, chastity and self-sufficiency.",category:"general",source:"Muslim 2721"},{id:"qadr-1",titleEn:"Dua for Laylatul Qadr",arabicText:"اللَّهُمَّ إِنَّكَ عَفُوٌّ تُحِبُّ الْعَفْوَ فَاعْفُ عَنِّي",transliteration:"Allahumma innaka 'afuwwun tuhibbul-'afwa fa'fu 'anni",translationEn:"O Allah, You are Pardoning and You love to pardon, so pardon me.",category:"laylatul-qadr",source:"Tirmidhi 3513"},{id:"qadr-2",titleEn:"Seeking the Night of Power",arabicText:"اللَّهُمَّ إِنِّي أَسْأَلُكَ مِنْ فَضْلِكَ وَرَحْمَتِكَ فَإِنَّهُ لَا يَمْلِكُهَا إِلَّا أَنْتَ",transliteration:"Allahumma inni as'aluka min fadlika wa rahmatika fa innahu laa yamlikuhaa illaa anta",translationEn:"O Allah, I ask You from Your bounty and mercy, for none possesses them except You.",category:"laylatul-qadr",source:"Al-Tabarani"}];var ve=[{id:"sehri",label:"Sehri"},{id:"iftar",label:"Iftar"},{id:"general",label:"General"},{id:"laylatul-qadr",label:"Laylatul Qadr"},{id:"favorites",label:"♥ Favorites"}],D="iftar";async function J(a){let e=await ma(),t=document.createDocumentFragment();t.appendChild(r("h1",{className:"page-title"},"Duas"));let n=r("div",{className:"category-tabs",role:"tablist"});for(let i of ve){let l=r("button",{className:`category-tab${i.id===D?" active":""}`,role:"tab","aria-selected":i.id===D?"true":"false"},i.label);l.addEventListener("click",()=>{D=i.id,J(a)}),n.appendChild(l)}t.appendChild(n);let s=ee,o;if(D==="favorites")o=s.filter((i)=>e.has(i.id));else o=s.filter((i)=>i.category===D);if(o.length===0){let i=r("div",{className:"error-state"});i.appendChild(r("div",{className:"error-icon"},D==="favorites"?"♡":"\uD83E\uDD32")),i.appendChild(r("div",{className:"error-message"},D==="favorites"?"No favorites yet. Tap the heart on any dua to save it.":"No duas in this category.")),t.appendChild(i)}else for(let i of o)t.appendChild(ae(i,e.has(i.id),async(l)=>{await Xa(l),J(a)}));c(a,t)}var Y=null;function ca(){if(Y)return Promise.resolve(Y);return new Promise((a,e)=>{let t=indexedDB.open(j,w);t.onsuccess=()=>{Y=t.result,a(Y)},t.onerror=()=>e(t.error)})}async function ga(){try{let a=await ca();return new Promise((e,t)=>{let o=a.transaction("quranProgress","readonly").objectStore("quranProgress").get("progress");o.onsuccess=()=>e(o.result||{id:"progress",completedDays:[],lastUpdated:""}),o.onerror=()=>t(o.error)})}catch{return{completedDays:[],lastUpdated:""}}}async function te(a){let e=await ga(),t=e.completedDays.indexOf(a);if(t>=0)e.completedDays.splice(t,1);else e.completedDays.push(a),e.completedDays.sort((n,s)=>n-s);e.lastUpdated=new Date().toISOString();try{let n=await ca();await new Promise((s,o)=>{let i=n.transaction("quranProgress","readwrite");i.objectStore("quranProgress").put({id:"progress",...e}),i.oncomplete=()=>s(),i.onerror=()=>o(i.error)})}catch{}return e}async function ne(){try{let a=await ca();await new Promise((e,t)=>{let n=a.transaction("quranProgress","readwrite");n.objectStore("quranProgress").put({id:"progress",completedDays:[],lastUpdated:new Date().toISOString()}),n.oncomplete=()=>e(),n.onerror=()=>t(n.error)})}catch{}}function re(a,e,t){let n=r("div",{className:`quran-day-card${e?" completed":""}`}),s=r("div",{className:"quran-day-info"});s.appendChild(r("div",{className:"quran-day-num"},`Day ${a.day} · Juz ${a.juz}`)),s.appendChild(r("div",{className:"quran-day-surah"},`${a.surahStart} ${a.ayahStart} – ${a.surahEnd} ${a.ayahEnd}`)),s.appendChild(r("div",{className:"quran-day-pages"},`Pages ${a.pages}`));let o=r("div",{className:"quran-checkbox"},e?"☑":"☐");return n.appendChild(s),n.appendChild(o),n.addEventListener("click",()=>t(a.day)),n}var se=[{day:1,juz:1,surahStart:"Al-Fatiha",ayahStart:1,surahEnd:"Al-Baqarah",ayahEnd:141,pages:"1–20"},{day:2,juz:2,surahStart:"Al-Baqarah",ayahStart:142,surahEnd:"Al-Baqarah",ayahEnd:252,pages:"21–40"},{day:3,juz:3,surahStart:"Al-Baqarah",ayahStart:253,surahEnd:"Al-Imran",ayahEnd:92,pages:"41–60"},{day:4,juz:4,surahStart:"Al-Imran",ayahStart:93,surahEnd:"An-Nisa",ayahEnd:23,pages:"61–80"},{day:5,juz:5,surahStart:"An-Nisa",ayahStart:24,surahEnd:"An-Nisa",ayahEnd:147,pages:"81–100"},{day:6,juz:6,surahStart:"An-Nisa",ayahStart:148,surahEnd:"Al-Ma'idah",ayahEnd:81,pages:"101–120"},{day:7,juz:7,surahStart:"Al-Ma'idah",ayahStart:82,surahEnd:"Al-An'am",ayahEnd:110,pages:"121–140"},{day:8,juz:8,surahStart:"Al-An'am",ayahStart:111,surahEnd:"Al-A'raf",ayahEnd:87,pages:"141–160"},{day:9,juz:9,surahStart:"Al-A'raf",ayahStart:88,surahEnd:"Al-Anfal",ayahEnd:40,pages:"161–180"},{day:10,juz:10,surahStart:"Al-Anfal",ayahStart:41,surahEnd:"At-Tawbah",ayahEnd:92,pages:"181–200"},{day:11,juz:11,surahStart:"At-Tawbah",ayahStart:93,surahEnd:"Hud",ayahEnd:5,pages:"201–220"},{day:12,juz:12,surahStart:"Hud",ayahStart:6,surahEnd:"Yusuf",ayahEnd:52,pages:"221–240"},{day:13,juz:13,surahStart:"Yusuf",ayahStart:53,surahEnd:"Ibrahim",ayahEnd:52,pages:"241–260"},{day:14,juz:14,surahStart:"Al-Hijr",ayahStart:1,surahEnd:"An-Nahl",ayahEnd:128,pages:"261–280"},{day:15,juz:15,surahStart:"Al-Isra",ayahStart:1,surahEnd:"Al-Kahf",ayahEnd:74,pages:"281–300"},{day:16,juz:16,surahStart:"Al-Kahf",ayahStart:75,surahEnd:"Ta-Ha",ayahEnd:135,pages:"301–320"},{day:17,juz:17,surahStart:"Al-Anbiya",ayahStart:1,surahEnd:"Al-Hajj",ayahEnd:78,pages:"321–340"},{day:18,juz:18,surahStart:"Al-Mu'minun",ayahStart:1,surahEnd:"Al-Furqan",ayahEnd:20,pages:"341–360"},{day:19,juz:19,surahStart:"Al-Furqan",ayahStart:21,surahEnd:"An-Naml",ayahEnd:55,pages:"361–380"},{day:20,juz:20,surahStart:"An-Naml",ayahStart:56,surahEnd:"Al-Ankabut",ayahEnd:45,pages:"381–400"},{day:21,juz:21,surahStart:"Al-Ankabut",ayahStart:46,surahEnd:"Al-Ahzab",ayahEnd:30,pages:"401–420"},{day:22,juz:22,surahStart:"Al-Ahzab",ayahStart:31,surahEnd:"Ya-Sin",ayahEnd:27,pages:"421–440"},{day:23,juz:23,surahStart:"Ya-Sin",ayahStart:28,surahEnd:"Az-Zumar",ayahEnd:31,pages:"441–460"},{day:24,juz:24,surahStart:"Az-Zumar",ayahStart:32,surahEnd:"Fussilat",ayahEnd:46,pages:"461–480"},{day:25,juz:25,surahStart:"Fussilat",ayahStart:47,surahEnd:"Al-Jathiyah",ayahEnd:37,pages:"481–500"},{day:26,juz:26,surahStart:"Al-Ahqaf",ayahStart:1,surahEnd:"Al-Hadid",ayahEnd:29,pages:"501–520"},{day:27,juz:27,surahStart:"Al-Mujadila",ayahStart:1,surahEnd:"At-Tahrim",ayahEnd:12,pages:"521–540"},{day:28,juz:28,surahStart:"Al-Mulk",ayahStart:1,surahEnd:"Al-Mursalat",ayahEnd:50,pages:"541–560"},{day:29,juz:29,surahStart:"An-Naba",ayahStart:1,surahEnd:"At-Takwir",ayahEnd:29,pages:"561–580"},{day:30,juz:30,surahStart:"Al-Infitar",ayahStart:1,surahEnd:"An-Nas",ayahEnd:6,pages:"581–604"}];async function K(a){let e=await ga(),t=new Set(e.completedDays),n=se,s=document.createDocumentFragment();s.appendChild(r("h1",{className:"page-title"},"Quran Plan"));let o=r("div",{className:"quran-progress"}),i=r("div",{className:"quran-progress-text"},`${t.size}/30 days complete`),l=r("div",{className:"quran-progress-bar"}),d=r("div",{className:"quran-progress-fill"});d.style.width=`${t.size/30*100}%`,l.appendChild(d),o.appendChild(i),o.appendChild(l),s.appendChild(o);for(let g of n)s.appendChild(re(g,t.has(g.day),async(f)=>{await te(f),K(a)}));let h=r("button",{className:"btn-reset"},"Reset Progress");h.addEventListener("click",async()=>{if(confirm("Are you sure you want to reset all Quran reading progress?"))await ne(),K(a)}),s.appendChild(h),c(a,s)}async function Ee(){let a=Ca();document.documentElement.setAttribute("data-theme",a.theme);let e={settings:a,currentMonthData:null,otherMonthData:null,todayData:null,nextPrayer:null,isOnline:navigator.onLine,isLoading:!0,error:null,methods:null};ba(e),v.init(),v.onChange((s)=>{u.setState({isOnline:s})}),await wa();let t=document.getElementById("app"),n=document.createElement("main");n.setAttribute("role","main"),t.appendChild(Pa()),t.appendChild(n),t.appendChild($a()),y.onRouteChange((s)=>{ie(s,n)});try{let{current:s,other:o}=await Ha(a);u.setState({currentMonthData:s.data,otherMonthData:o?.data||null,isLoading:!1,error:s.source==="error"?s.error||"Failed to load data":null});let i=Ya();u.setState({todayData:i})}catch(s){u.setState({isLoading:!1,error:s.message||"Failed to load prayer times"})}if(O().then((s)=>u.setState({methods:s})).catch(()=>{}),y.init(),!window.location.hash||window.location.hash==="#/"||window.location.hash==="#")ie("today",n);if("serviceWorker"in navigator)navigator.serviceWorker.register("/sw.js").catch(()=>{})}function ie(a,e){switch(Ja(),a){case"today":_a(e);break;case"calendar":Q(e);break;case"settings":Za(e);break;case"duas":J(e);break;case"quran":K(e);break}}Ee().catch(console.error);
